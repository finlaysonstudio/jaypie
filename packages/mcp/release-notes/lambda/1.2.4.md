---
version: 1.2.4
date: 2025-01-23
summary: Add WebSocket Lambda handler
---

## New Features

### websocketHandler

Lambda handler for WebSocket API Gateway events with lifecycle management:

```typescript
export const handler = websocketHandler(async (event, context) => {
  const { routeKey, connectionId, body } = context;

  // Send to this connection
  await context.send({ received: true });

  // Broadcast to multiple connections
  await context.broadcast(connectionIds, { message: "hello" });

  return { statusCode: 200 };
}, {
  name: "chat",
  secrets: ["MONGODB_URI"],
});
```

### WebSocket Context

- `routeKey` - Route key ($connect, $disconnect, $default, or custom)
- `connectionId` - WebSocket connection ID
- `domainName` - API Gateway domain
- `stage` - API Gateway stage
- `body` - Message body (null for connect/disconnect)
- `queryStringParameters` - Query params (available on $connect)
- `send(data)` - Send to current connection
- `broadcast(connectionIds, data)` - Send to multiple connections
